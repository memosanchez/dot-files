Create a comprehensive test plan for the recent changes, including:

## Unit Tests
- List specific functions/methods that need unit tests
- Describe test cases for each function (happy path, edge cases, error conditions)
- Identify which mocks or fixtures are needed

## Integration Tests
- Describe component interactions that should be tested
- List integration scenarios to verify

## Manual Testing Checklist
- [ ] Step-by-step manual testing procedures
- [ ] Expected outcomes for each step
- [ ] Edge cases to verify manually

## Test Data
- Describe test data requirements
- List any setup/teardown needs

Format the test plan as a markdown checklist that can be followed during implementation.
